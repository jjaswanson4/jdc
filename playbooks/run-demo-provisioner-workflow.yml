---

- name: run demo provisioner workflow
  hosts:
    - all
  gather_facts: no
  vars_files:
    - vars/demos.yml
  pre_tasks:
    - name: match demo to display name
      ansible.builtin.set_fact:
        demo_display_name: "{{ demos.display_name }}"
      when:
        - demo == demos.name
      loop_control:
        loop_var: demos
      loop: "{{ available_demos }}"
    - name: set demo provisioner workflow facts
      ansible.builtin.set_fact:
        controller_workflow_launch_jobs:
          - name: "Provision {{ demo_display_name }} Demo"
            inventory: "{{ audience }} - {{ demo }} Infrastructure"
            wait: no
            extra_vars:
              audience: "{{ audience }}"
              demo_uuid: "{{ demo_uuid }}"
  roles:
    - redhat_cop.controller_configuration.workflow_launch