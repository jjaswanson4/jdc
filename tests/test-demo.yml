---

- name: test specified demo
  hosts:
    - localhost
  gather_facts: no
  vars:
    ansible_connection: local
  vars_files:
    - /home/gitlab-runner/gitlab-runner-extra-vars.yml
  pre_tasks:
    - name: print out specified demo to test
      ansible.builtin.debug:
        msg: "Demo to test: {{ demo }}"
    - name: set dict for role
      ansible.builtin.set_fact:
        controller_launch_jobs:
          - name: Provision Demo
            extra_vars:
              demo: "{{ demo }}"
              audience: Github-Actions
              provisioner: Github Actions
              provisioner_email: joshswanson@redhat.com
              demo_uuid: "{{ demo_uuid }}"
              wait: yes
              timeout: 28800
  tasks:
    - name: run role to launch job
      ansible.builtin.include_role:
        name: redhat_cop.controller_configuration.job_launch
    - name: print out launched jobs
      ansible.builtin.debug:
        msg: "{{ launched_controller_jobs }}"
