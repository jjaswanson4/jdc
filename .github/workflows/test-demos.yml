---

name: Test Demos
on: [push]
jobs:
  Test-Patching-Demo:
    runs-on: self-hosted
    steps:
      - name: Check out repository code
        uses: actions/checkout@v2
      - name: List files in the repository
        run: |
          ls ${{ github.workspace }}
      - name: Test provisioning demo (check controller for details)
        run: >
          ansible-playbook ${{ github.workspace }}/tests/test-demo.yml
          --extra-vars "demo=patching"
          --extra-vars "demo_uuid=${{ github.run_id }}"
      - name: Report provisioning success
        run: echo "Provisioning successful."
      - name: Teardown demo
        run: >
          ansible-playbook ${{ github.workspace }}/tests/test-demo.yml
          --extra-vars "demo=patching"
          --extra-vars "demo_uuid=${{ github.run_id }}"