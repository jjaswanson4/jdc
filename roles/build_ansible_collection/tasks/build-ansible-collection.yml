---

- name: use ansible-galaxy to build collection
  ansible.builtin.shell:
    cmd: ansible-galaxy collection build
    chdir: "{{ demo_ansible_collections_working_directory }}/{{ collection.fqcn.split('.')[1] }}"
  changed_when:
    - "'Created collection' in extracted_collection.stdout"
  failed_when:
    - "'Created collection' not in extracted_collection.stdout"
    - "'already exists' not in extracted_collection.stderr"